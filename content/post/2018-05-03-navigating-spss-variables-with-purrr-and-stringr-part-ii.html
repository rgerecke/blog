---
title: navigating SPSS variables with purrr and stringr - part ii
author: renata gerecke
date: '2018-05-03'
categories:
  - haven
  - purrr
  - rstats
  - spss
  - stringr
tags:
  - haven
  - purrr
  - rstats
  - spss
  - stringr
slug: navigating-spss-variables-with-purrr-and-stringr-part-ii
---



<div id="recap" class="section level2">
<h2>Recap</h2>
<p>Last post, I wrote about how we can access SPSS variable metadata using the <code>attributes()</code> and <code>attr()</code> functions in R; in combination with <code>purrr:map_chr()</code> we can easily view variable labels, levels, and more.</p>
<p>Though the sample data I’ve created only has 10 variables, often I find myself working with hundreds, and little idea how to find the precise variable names I’m looking for. I’ve found <code>stringr:str_extract()</code> to be particularly powerful in this scenario.</p>
<p>The data we have asks respondents various combinations of two things: to what degree do you [share/read] on [given social network]. Let’s say I want to find the questions which ask about Twitter. I can use the following:</p>
<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ───────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ ggplot2 2.2.1     ✔ purrr   0.2.4
## ✔ tibble  1.4.2     ✔ dplyr   0.7.4
## ✔ tidyr   0.8.0     ✔ stringr 1.3.0
## ✔ readr   1.1.1     ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ──────────────── tidyverse_conflicts() ──
## ✖ dplyr::filter() masks stats::filter()
## ✖ dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>library(haven)


df &lt;- read_sav(&quot;../../static/data/SampleData.sav&quot;)

# find_Twitter &lt;- df %&gt;% 
#   map_chr(~attr(., &quot;label&quot;)) %&gt;%
#   enframe() %&gt;%
#   filter(str_which(.$value, &quot;Twitter&quot;))
# 
# df %&gt;%
#   select(find_Twitter)</code></pre>
<p>We can now see that <code>q1</code> and <code>q6</code> are the questions which ask about Twitter behavior.</p>
</div>
